{% extends 'home/base.html' %}
{% load static %}

{% block title %}PortfolAI Dashboard{% endblock %}

{% block extra_css %}
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
<link rel="stylesheet" href="{% static 'home/dashboard/dashboard.css' %}">
<style>
  /* Override base template styles for dashboard */
  body {
    background-color: #23252e !important;
    color: #8a8fa7 !important;
    font-family: 'Lato', sans-serif !important;
  }
  
  #mainContent {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  #sidebar {
    display: none; /* Hide sidebar for dashboard */
  }
</style>
{% endblock %}

{% block content %}
<div class="grid-container">
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <a href="{% url 'index' %}" style="text-decoration: none; color: inherit;">PORTFOLAI</a>
    </div>
    <div class="header-left">
      <ul class="list">
        <li class="list-item">
          <a href="{% url 'index' %}">
            <span class="material-icons-outlined">home</span> HOME
          </a>
        </li>
        <li class="list-item active">
          <a href="{% url 'dashboard' %}">
            <span class="material-icons-outlined">dashboard</span> DASHBOARD
          </a>
        </li>
        <li class="list-item">
          <a href="#">
            <span class="material-icons-outlined">inventory_2</span> PORTFOLIOS
          </a>
        </li>
        <li class="list-item">
          <a href="#">
            <span class="material-icons-outlined">poll</span> ANALYTICS
          </a>
        </li>
        <li class="list-item">
          <a href="#">
            <span class="material-icons-outlined">settings</span> SETTINGS
          </a>
        </li>
      </ul>
    </div>
    <div class="header-right">
      <span class="material-icons-outlined">notifications</span>
      <span class="material-icons-outlined">email</span>
      <span class="material-icons-outlined">account_circle</span>
    </div>
  </header>
  <!-- End Header -->

         <!-- Main -->
         <main class="main-container">
           <!-- TradingView Ticker Tape -->
           <div class="ticker-tape-section">
             <div class="ticker-tape-header">
               <h2 class="ticker-tape-title">
                 <span class="material-icons-outlined">trending_up</span>
                 Market Overview
               </h2>
             </div>
             <div class="tradingview-widget-container">
               <div class="tradingview-widget-container__widget"></div>
               <div class="tradingview-widget-copyright">
                 <a href="https://www.tradingview.com/markets/" rel="noopener nofollow" target="_blank">
                   <span class="blue-text">Ticker tape</span>
                 </a>
                 <span class="trademark"> by TradingView</span>
               </div>
             </div>
           </div>

           <!-- Compact Search Section -->
           <div class="search-section">
             <div class="search-container">
               <div class="search-input-group">
                 <input 
                   type="text" 
                   id="stock-search" 
                   placeholder="Search stocks..." 
                   class="search-input"
                 >
                 <button id="search-btn" class="search-btn">
                   <span class="material-icons-outlined">search</span>
                 </button>
               </div>
               <div id="search-results" class="search-results"></div>
             </div>
           </div>

    <!-- Top Stock Portfolio Cards -->
    <div class="main-cards">
      <div class="stock-card" data-symbol="AAPL">
        <div class="stock-card-header">
          <div class="stock-logo aapl-logo">AAPL</div>
          <div class="stock-company">Apple, Inc</div>
        </div>
        <div class="stock-price-info">
          <div class="stock-price" id="aapl-price">$192.53</div>
          <div class="stock-change positive" id="aapl-change">+3.59%</div>
        </div>
      </div>
      
      <div class="stock-card" data-symbol="PYPL">
        <div class="stock-card-header">
          <div class="stock-logo pypl-logo">PYPL</div>
          <div class="stock-company">PayPal, Inc</div>
        </div>
        <div class="stock-price-info">
          <div class="stock-price" id="pypl-price">$192.53</div>
          <div class="stock-change positive" id="pypl-change">+1.01%</div>
        </div>
      </div>

      <div class="stock-card" data-symbol="TSLA">
        <div class="stock-card-header">
          <div class="stock-logo tsla-logo">TSLA</div>
          <div class="stock-company">Tesla, Inc</div>
        </div>
        <div class="stock-price-info">
          <div class="stock-price" id="tsla-price">$192.53</div>
          <div class="stock-change positive" id="tsla-change">+1.01%</div>
        </div>
      </div>

      <div class="stock-card" data-symbol="AMZN">
        <div class="stock-card-header">
          <div class="stock-logo amzn-logo">AMZN</div>
          <div class="stock-company">Amazon.com, Inc</div>
        </div>
        <div class="stock-price-info">
          <div class="stock-price" id="amzn-price">$192.53</div>
          <div class="stock-change positive" id="amzn-change">+1.01%</div>
        </div>
      </div>
    </div>

    <!-- Selected Stock Information (Hidden - replaced by top cards) -->
    <div class="stock-info-section" id="stock-info-section" style="display: none;">
      <div class="stock-info-card">
        <div class="stock-header">
          <div class="stock-symbol" id="stock-symbol-display">-</div>
          <div class="stock-company" id="stock-company-display">-</div>
        </div>
        <div class="stock-price-info">
          <div class="current-price" id="current-price-display">$0.00</div>
          <div class="price-change" id="price-change-display">$0.00 (0.00%)</div>
        </div>
        <div class="stock-details">
          <div class="detail-item">
            <span class="detail-label">High:</span>
            <span class="detail-value" id="stock-high">$0.00</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Low:</span>
            <span class="detail-value" id="stock-low">$0.00</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Open:</span>
            <span class="detail-value" id="stock-open">$0.00</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Previous Close:</span>
            <span class="detail-value" id="stock-prev-close">$0.00</span>
          </div>
        </div>
      </div>
    </div>

    <!-- My Watchlist Section -->
    <div class="watchlist-section">
      <div class="section-header">
        <h2 class="section-title">My Watchlist</h2>
        <div class="section-actions">
          <button class="action-btn view-more-btn">View More</button>
          <button id="clear-watchlist-btn" class="action-btn delete-btn">Delete</button>
        </div>
      </div>
      <div class="watchlist-container" id="watchlist-container">
        <div class="watchlist-empty" id="watchlist-empty">
          <span class="material-icons-outlined">star_border</span>
          <p>No stocks in watchlist</p>
          <small>Search and add stocks to your watchlist</small>
        </div>
        <div class="watchlist-grid" id="watchlist-grid" style="display: none;">
          <!-- Watchlist items will be populated here -->
        </div>
      </div>
    </div>

    <div class="charts">

      <div class="charts-card">
        <div class="chart-header">
          <h3 class="chart-title">Portfolio Performance</h3>
          <div class="chart-tabs">
            <button class="tab-btn active" data-period="monthly">Monthly</button>
            <button class="tab-btn" data-period="quarterly">Quarterly</button>
            <button class="tab-btn" data-period="annually">Annually</button>
          </div>
        </div>
        <div id="bar-chart"></div>
      </div>

      <div class="charts-card">
        <p class="chart-title">Stock Analysis Trends - <span id="chart-stock-symbol">Select a stock to view trends</span></p>
        <div id="area-chart"></div>
      </div>

    </div>

    <!-- Trending Stocks Section -->
    <div class="trending-stocks-section">
      <div class="section-header">
        <h2 class="section-title">Trending Stocks</h2>
      </div>
      <div class="trending-stocks-grid">
        <div class="trending-stock-card" data-symbol="TSLA">
          <div class="trending-stock-header">
            <div class="trending-stock-logo tsla-logo">TSLA</div>
            <div class="trending-stock-info">
              <div class="trending-stock-symbol">TSLA</div>
              <div class="trending-stock-company">Tesla, Inc</div>
            </div>
          </div>
          <div class="trending-stock-price-info">
            <div class="trending-stock-price" id="trending-tsla-price">$192.53</div>
            <div class="trending-stock-change positive" id="trending-tsla-change">+1.01%</div>
          </div>
          <div class="trending-stock-actions">
            <button class="action-btn short-btn">Short Stock</button>
            <button class="action-btn buy-btn">Buy Stock</button>
          </div>
        </div>

        <div class="trending-stock-card" data-symbol="AAPL">
          <div class="trending-stock-header">
            <div class="trending-stock-logo aapl-logo">AAPL</div>
            <div class="trending-stock-info">
              <div class="trending-stock-symbol">AAPL</div>
              <div class="trending-stock-company">Apple, Inc</div>
            </div>
          </div>
          <div class="trending-stock-price-info">
            <div class="trending-stock-price" id="trending-aapl-price">$192.53</div>
            <div class="trending-stock-change positive" id="trending-aapl-change">+3.59%</div>
          </div>
          <div class="trending-stock-actions">
            <button class="action-btn short-btn">Short Stock</button>
            <button class="action-btn buy-btn">Buy Stock</button>
          </div>
        </div>

        <div class="trending-stock-card" data-symbol="SPOT">
          <div class="trending-stock-header">
            <div class="trending-stock-logo spot-logo">SPOT</div>
            <div class="trending-stock-info">
              <div class="trending-stock-symbol">SPOT</div>
              <div class="trending-stock-company">Spotify, Inc</div>
            </div>
          </div>
          <div class="trending-stock-price-info">
            <div class="trending-stock-price" id="trending-spot-price">$192.53</div>
            <div class="trending-stock-change positive" id="trending-spot-change">+1.01%</div>
          </div>
          <div class="trending-stock-actions">
            <button class="action-btn short-btn">Short Stock</button>
            <button class="action-btn buy-btn">Buy Stock</button>
          </div>
        </div>

        <div class="trending-stock-card" data-symbol="PYPL">
          <div class="trending-stock-header">
            <div class="trending-stock-logo pypl-logo">PYPL</div>
            <div class="trending-stock-info">
              <div class="trending-stock-symbol">PYPL</div>
              <div class="trending-stock-company">PayPal, Inc</div>
            </div>
          </div>
          <div class="trending-stock-price-info">
            <div class="trending-stock-price" id="trending-pypl-price">$192.53</div>
            <div class="trending-stock-change positive" id="trending-pypl-change">+1.01%</div>
          </div>
          <div class="trending-stock-actions">
            <button class="action-btn short-btn">Short Stock</button>
            <button class="action-btn buy-btn">Buy Stock</button>
          </div>
        </div>

        <div class="trending-stock-card" data-symbol="AMZN">
          <div class="trending-stock-header">
            <div class="trending-stock-logo amzn-logo">AMZN</div>
            <div class="trending-stock-info">
              <div class="trending-stock-symbol">AMZN</div>
              <div class="trending-stock-company">Amazon.com, Inc</div>
            </div>
          </div>
          <div class="trending-stock-price-info">
            <div class="trending-stock-price" id="trending-amzn-price">$192.53</div>
            <div class="trending-stock-change positive" id="trending-amzn-change">+1.01%</div>
          </div>
          <div class="trending-stock-actions">
            <button class="action-btn short-btn">Short Stock</button>
            <button class="action-btn buy-btn">Buy Stock</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Dividend Section -->
    <div class="dividend-section">
      <div class="section-header">
        <h2 class="section-title">Dividend</h2>
        <div class="section-actions">
          <button class="action-btn view-more-btn">View More</button>
          <button class="action-btn delete-btn">Delete</button>
        </div>
      </div>
      <div class="dividend-content">
        <div class="dividend-item">
          <div class="dividend-logo aapl-logo">AAPL</div>
          <div class="dividend-info">
            <div class="dividend-symbol">Apple Inc.</div>
            <div class="dividend-amount">$0.24 per share</div>
          </div>
          <div class="dividend-date">Next: Dec 15</div>
        </div>
        <div class="dividend-item">
          <div class="dividend-logo msft-logo">MSFT</div>
          <div class="dividend-info">
            <div class="dividend-symbol">Microsoft Corp.</div>
            <div class="dividend-amount">$0.75 per share</div>
          </div>
          <div class="dividend-date">Next: Dec 12</div>
        </div>
        <div class="dividend-item">
          <div class="dividend-logo jnj-logo">JNJ</div>
          <div class="dividend-info">
            <div class="dividend-symbol">Johnson & Johnson</div>
            <div class="dividend-amount">$1.19 per share</div>
          </div>
          <div class="dividend-date">Next: Dec 10</div>
        </div>
        <div class="dividend-item">
          <div class="dividend-logo pg-logo">PG</div>
          <div class="dividend-info">
            <div class="dividend-symbol">Procter & Gamble</div>
            <div class="dividend-amount">$0.94 per share</div>
          </div>
          <div class="dividend-date">Next: Dec 20</div>
        </div>
      </div>
    </div>

    <!-- Top 5 Trends Table -->
    <div class="trends-table-section">
      <div class="section-header">
        <h2 class="section-title">Top 5 Trends</h2>
        <div class="section-actions">
          <button class="action-btn view-more-btn">View More</button>
          <button class="action-btn delete-btn">Delete</button>
        </div>
      </div>
      <div class="trends-table-container">
        <table class="trends-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Date</th>
              <th>Price</th>
              <th>Category</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <div class="trend-name">
                  <div class="trend-logo nvda-logo">NVDA</div>
                  <span>NVIDIA Corp.</span>
                </div>
              </td>
              <td>Nov 23, 01:00 PM</td>
              <td>$2,567.88</td>
              <td>Technology</td>
              <td><span class="status-badge rising">Rising</span></td>
              <td>
                <button class="action-btn view-more-btn">View More</button>
                <button class="action-btn delete-btn">Delete</button>
              </td>
            </tr>
            <tr>
              <td>
                <div class="trend-name">
                  <div class="trend-logo msft-logo">MSFT</div>
                  <span>Microsoft Corp.</span>
                </div>
              </td>
              <td>Nov 22, 09:00 PM</td>
              <td>$2,567.88</td>
              <td>Technology</td>
              <td><span class="status-badge rising">Rising</span></td>
              <td>
                <button class="action-btn view-more-btn">View More</button>
                <button class="action-btn delete-btn">Delete</button>
              </td>
            </tr>
            <tr>
              <td>
                <div class="trend-name">
                  <div class="trend-logo googl-logo">GOOGL</div>
                  <span>Alphabet Inc.</span>
                </div>
              </td>
              <td>Oct 12, 03:54 PM</td>
              <td>$6,754.99</td>
              <td>Technology</td>
              <td><span class="status-badge falling">Falling</span></td>
              <td>
                <button class="action-btn view-more-btn">View More</button>
                <button class="action-btn delete-btn">Delete</button>
              </td>
            </tr>
            <tr>
              <td>
                <div class="trend-name">
                  <div class="trend-logo meta-logo">META</div>
                  <span>Meta Platforms</span>
                </div>
              </td>
              <td>Sep 09, 02:00 AM</td>
              <td>$1,445.41</td>
              <td>Social Media</td>
              <td><span class="status-badge stable">Stable</span></td>
              <td>
                <button class="action-btn view-more-btn">View More</button>
                <button class="action-btn delete-btn">Delete</button>
              </td>
            </tr>
            <tr>
              <td>
                <div class="trend-name">
                  <div class="trend-logo nflx-logo">NFLX</div>
                  <span>Netflix Inc.</span>
                </div>
              </td>
              <td>Feb 35, 08:00 PM</td>
              <td>$5,698.55</td>
              <td>Entertainment</td>
              <td><span class="status-badge rising">Rising</span></td>
              <td>
                <button class="action-btn view-more-btn">View More</button>
                <button class="action-btn delete-btn">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="table-pagination">
          <button class="pagination-btn">Previous</button>
          <span class="pagination-info">Page 1 of 10</span>
          <button class="pagination-btn">Next</button>
        </div>
      </div>
    </div>
  </main>
  <!-- End Main -->
</div>
{% endblock %}

{% block extra_js %}
<!-- ApexCharts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.40.0/apexcharts.min.js"></script>
<script src="{% static 'home/dashboard/dashboard.js' %}"></script>
{% endblock %}
